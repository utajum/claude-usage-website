---
import { Image } from 'astro:assets';
import screenshotLinux from '../assets/images/screenshot-linux.png';
import screenshotWin from '../assets/images/screenshot-win.png';
import cashOnFire from '../assets/images/cash on fire.jpg';

interface PlatformGroup {
  family: string;
  total: number;
  percentage: number;
  items: { name: string; count: number }[];
}

interface Props {
  fetchOk: boolean;
  totalDownloads: number;
  latestVersion: string | null;
  stars: number;
  groupedData: PlatformGroup[];
}

const { fetchOk, totalDownloads, latestVersion, stars, groupedData } = Astro.props;

function formatNumber(n: number): string {
  if (n >= 1_000_000) return (n / 1_000_000).toFixed(1).replace(/\.0$/, '') + 'M';
  if (n >= 1_000) return (n / 1_000).toFixed(1).replace(/\.0$/, '') + 'k';
  return n.toLocaleString();
}

function getFamilyIcon(family: string): string {
  const lower = family.toLowerCase();
  if (lower === 'macos') {
    return '<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/></svg>';
  }
  if (lower === 'windows') {
    return '<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M3 12V6.75l6-1.32v6.48L3 12m17-9v8.75l-10 .15V5.21L20 3M3 13l6 .09v6.81l-6-1.15V13m17 .25V22l-10-1.91V13.1l10 .15z"/></svg>';
  }
  if (lower === 'linux') {
    return '<span style="font-size: 1.4rem; line-height: 1;">üêß</span>';
  }
  return '<span style="font-size: 1.4rem; line-height: 1;">üì¶</span>';
}
---

<!-- Hero: Pixel-accurate systray chip icon from the Go source code -->
<section class="hero">
  <!-- Background image: cash on fire - faded -->
  <Image 
    src={cashOnFire} 
    alt="" 
    class="hero-bg"
    loading="eager"
  />
  <div class="container">
    <div class="hero-content">

      <!-- Chip Icon - pixel-accurate recreation of RenderChipImage() from internal/icon/render.go
           22x22 grid. Body: #B400FF from (2,2)-(19,19). Pins: #00FFFF 2x2 blocks every 3px from 5.
           Text: "72" using the 7x9 digitPatterns font, white, centered. -->
      <div class="chip-container">
        <div class="chip-glow"></div>
        <svg class="chip-icon" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg" aria-label="claude-usage systray icon showing 67%">
          <defs>
            <filter id="chipGlow" x="-80%" y="-80%" width="260%" height="260%">
              <feGaussianBlur stdDeviation="1.2" result="blur" />
              <feMerge>
                <feMergeNode in="blur" />
                <feMergeNode in="SourceGraphic" />
              </feMerge>
            </filter>
          </defs>

          <!-- Chip body - purple rectangle (2,2) to (19,19) with corner cuts -->
          <rect x="2" y="2" width="18" height="18" fill="#B400FF" />
          <!-- Corner cuts (transparent pixels at the 4 corners of the body) -->
          <rect x="2" y="2" width="1" height="1" fill="#141218" />
          <rect x="19" y="2" width="1" height="1" fill="#141218" />
          <rect x="2" y="19" width="1" height="1" fill="#141218" />
          <rect x="19" y="19" width="1" height="1" fill="#141218" />

          <!-- Cyan pins - top edge (y=0..1, 2x2 blocks at x=5,8,11,14,17) -->
          <rect x="5" y="0" width="2" height="2" fill="#00FFFF" />
          <rect x="8" y="0" width="2" height="2" fill="#00FFFF" />
          <rect x="11" y="0" width="2" height="2" fill="#00FFFF" />
          <rect x="14" y="0" width="2" height="2" fill="#00FFFF" />
          <!-- Bottom pins (y=20..21) -->
          <rect x="5" y="20" width="2" height="2" fill="#00FFFF" />
          <rect x="8" y="20" width="2" height="2" fill="#00FFFF" />
          <rect x="11" y="20" width="2" height="2" fill="#00FFFF" />
          <rect x="14" y="20" width="2" height="2" fill="#00FFFF" />
          <!-- Left pins (x=0..1) -->
          <rect x="0" y="5" width="2" height="2" fill="#00FFFF" />
          <rect x="0" y="8" width="2" height="2" fill="#00FFFF" />
          <rect x="0" y="11" width="2" height="2" fill="#00FFFF" />
          <rect x="0" y="14" width="2" height="2" fill="#00FFFF" />
          <!-- Right pins (x=20..21) -->
          <rect x="20" y="5" width="2" height="2" fill="#00FFFF" />
          <rect x="20" y="8" width="2" height="2" fill="#00FFFF" />
          <rect x="20" y="11" width="2" height="2" fill="#00FFFF" />
          <rect x="20" y="14" width="2" height="2" fill="#00FFFF" />

          <!-- "67" - digitPatterns from render.go, 7x9 font, charWidth=8
               Shifted 1px left from center: "6" at (3,7), "7" at (11,7) -->
          <!-- Digit "6" at (3,7) -->
          <!-- Row 0: 0111110 --> <rect x="4" y="7" width="5" height="1" fill="#d0c8e0" />
          <!-- Row 1: 1111111 --> <rect x="3" y="8" width="7" height="1" fill="#d0c8e0" />
          <!-- Row 2: 1100000 --> <rect x="3" y="9" width="2" height="1" fill="#d0c8e0" />
          <!-- Row 3: 1111110 --> <rect x="3" y="10" width="6" height="1" fill="#d0c8e0" />
          <!-- Row 4: 1111111 --> <rect x="3" y="11" width="7" height="1" fill="#d0c8e0" />
          <!-- Row 5: 1100011 --> <rect x="3" y="12" width="2" height="1" fill="#d0c8e0" /><rect x="8" y="12" width="2" height="1" fill="#d0c8e0" />
          <!-- Row 6: 1100011 --> <rect x="3" y="13" width="2" height="1" fill="#d0c8e0" /><rect x="8" y="13" width="2" height="1" fill="#d0c8e0" />
          <!-- Row 7: 1111111 --> <rect x="3" y="14" width="7" height="1" fill="#d0c8e0" />
          <!-- Row 8: 0111110 --> <rect x="4" y="15" width="5" height="1" fill="#d0c8e0" />

          <!-- Digit "7" at (11,7) -->
          <!-- Row 0: 1111111 --> <rect x="11" y="7" width="7" height="1" fill="#d0c8e0" />
          <!-- Row 1: 1111111 --> <rect x="11" y="8" width="7" height="1" fill="#d0c8e0" />
          <!-- Row 2: 0000011 --> <rect x="16" y="9" width="2" height="1" fill="#d0c8e0" />
          <!-- Row 3: 0000110 --> <rect x="15" y="10" width="2" height="1" fill="#d0c8e0" />
          <!-- Row 4: 0001100 --> <rect x="14" y="11" width="2" height="1" fill="#d0c8e0" />
          <!-- Row 5: 0011000 --> <rect x="13" y="12" width="2" height="1" fill="#d0c8e0" />
          <!-- Row 6: 0011000 --> <rect x="13" y="13" width="2" height="1" fill="#d0c8e0" />
          <!-- Row 7: 0011000 --> <rect x="13" y="14" width="2" height="1" fill="#d0c8e0" />
          <!-- Row 8: 0011000 --> <rect x="13" y="15" width="2" height="1" fill="#d0c8e0" />
        </svg>
      </div>

      <script>
        const chip = document.querySelector('.chip-container') as HTMLElement;
        if (chip) {
          const maxDist = 800;   // radius of influence (px) - most of the viewport!
          const maxPush = 500;   // max displacement (px) - extreme escape distance!
          const speedUp = 4;     // float animation speed multiplier on hover

          let ax = 0, ay = 0;   // current animated offset
          let tx = 0, ty = 0;   // target offset
          let raf: number;
          let hovering = false;

          function lerp(a: number, b: number, t: number) { return a + (b - a) * t; }

          function animate() {
            // Ease toward target - snappy when fleeing, springy when returning
            const ease = hovering ? 0.15 : 0.08;
            ax = lerp(ax, tx, ease);
            ay = lerp(ay, ty, ease);

            // Float speed: normal 6s, on hover ~1.5s via custom property
            const speed = hovering ? speedUp : 1;
            chip.style.setProperty('--float-speed', `${6 / speed}s`);

            chip.style.transform = `translate(${ax}px, ${ay}px)`;

            if (Math.abs(ax - tx) > 0.1 || Math.abs(ay - ty) > 0.1) {
              raf = requestAnimationFrame(animate);
            } else {
              ax = tx;
              ay = ty;
              chip.style.transform = `translate(${ax}px, ${ay}px)`;
            }
          }

          document.addEventListener('mousemove', (e) => {
            const rect = chip.getBoundingClientRect();
            const cx = rect.left + rect.width / 2;
            const cy = rect.top + rect.height / 2;

            const dx = cx - e.clientX;
            const dy = cy - e.clientY;
            const dist = Math.sqrt(dx * dx + dy * dy);

            if (dist < maxDist) {
              hovering = true;
              // Push away: direction is from cursor to chip center, strength inversely proportional to distance
              const strength = 1 - dist / maxDist;
              const push = strength * strength * maxPush; // quadratic falloff
              const angle = Math.atan2(dy, dx);
              tx = Math.cos(angle) * push;
              ty = Math.sin(angle) * push;
            } else {
              hovering = false;
              tx = 0;
              ty = 0;
            }

            cancelAnimationFrame(raf);
            raf = requestAnimationFrame(animate);
          });

          // Reset when cursor leaves the viewport
          document.addEventListener('mouseleave', () => {
            hovering = false;
            tx = 0;
            ty = 0;
            cancelAnimationFrame(raf);
            raf = requestAnimationFrame(animate);
          });
        }
      </script>

      <!-- Text content -->
      <div class="hero-text">
        <h1>claude<span class="highlight">-usage</span></h1>
        <p class="tagline">System tray token monitor</p>
        <p class="subtitle">Watch your tokens burn in real-time. Feel your wallet weep in high definition. Because ignorance isn't bliss - it's an invoice.</p>
        
        <div class="hero-buttons">
          <a href="https://github.com/utajum/claude-usage" class="btn btn-primary" target="_blank" rel="noopener noreferrer">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
            View on GitHub
          </a>
          <a href="#install" class="btn btn-outline">
            Install now
          </a>
          <a href="https://buymeacoffee.com/utajum" class="btn btn-outline" target="_blank" rel="noopener noreferrer">
            <svg width="20" height="20" viewBox="0 0 884 1279" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M791 298c-1-4-2-7-4-10-3-5-7-8-12-11-4-2-8-3-13-3H121c-5 0-9 1-13 3-5 3-9 6-12 11-2 3-3 6-4 10l-1 5-77 620c-6 49 7 98 37 137s74 63 123 67h1l6 1h459c50 0 97-22 130-60 32-38 47-87 41-136l-77-627-1-5v-2zm-72 622c3 26-4 51-21 71s-42 31-68 31H253l-4-1c-25-2-49-14-64-35s-22-46-19-71l74-594h444l57 460 18 139z"/>
              <path d="M670 395H213l-49 393c-4 33 5 66 26 92s52 43 83 47h1l3 1h327c34 0 65-15 87-41s33-58 27-91l-48-401zm-31 48l45 372c4 22-3 45-18 61s-36 28-59 28H280l-2-1c-21-2-40-13-54-31s-20-40-17-62l42-337h2l388-30z"/>
              <path d="M286 225c-2-2-3-6-3-9 0-4 1-7 3-9l48-75c5-7 5-16 2-24s-11-14-19-16l-7-1c-6 0-12 2-16 6l-80 124c-3 4-4 8-4 12 0 5 2 9 5 13 3 3 7 5 12 6h13c6 0 12-2 16-6l26-17 4-4zm152 0c-2-2-3-6-3-9 0-4 1-7 3-9l48-75c5-7 5-16 2-24s-11-14-19-16l-7-1c-6 0-12 2-16 6l-80 124c-3 4-4 8-4 12 0 5 2 9 5 13 3 3 7 5 12 6h13c6 0 12-2 16-6l26-17 4-4zm152 0c-2-2-3-6-3-9 0-4 1-7 3-9l48-75c5-7 5-16 2-24s-11-14-19-16l-7-1c-6 0-12 2-16 6l-80 124c-3 4-4 8-4 12 0 5 2 9 5 13 3 3 7 5 12 6h13c6 0 12-2 16-6l26-17 4-4z"/>
            </svg>
            Buy me a coffee
          </a>
        </div>
      </div>

      <!-- Screenshots -->
      <div class="hero-screenshots">
        <div class="screenshot-linux">
          <Image src={screenshotLinux} alt="claude-usage Linux system tray tooltip showing progress bars" loading="eager" format="webp" quality={85} data-lightbox />
        </div>
        <div class="screenshot-windows">
          <Image src={screenshotWin} alt="claude-usage Windows system tray tooltip" loading="eager" format="webp" quality={85} data-lightbox />
        </div>
      </div>

      <!-- Stats -->
      {fetchOk && (
        <div class="stats-row" id="statsRow">
          <div class="stat-item" id="statDownloadsItem" style="cursor: pointer;">
            <span class="stat-value" id="statDownloads" data-count={totalDownloads}>{formatNumber(totalDownloads)}</span>
            <span class="stat-label">Total Downloads</span>
          </div>
          <div class="stat-item">
            <span class="stat-value" id="statVersion">{latestVersion || '--'}</span>
            <span class="stat-label">Latest Version</span>
          </div>
          <div class="stat-item">
            <span class="stat-value" id="statStars" data-count={stars}>{formatNumber(stars)}</span>
            <span class="stat-label">GitHub Stars</span>
          </div>
        </div>
      )}

    </div>
  </div>
</section>

<!-- Downloads Modal (outside hero to avoid overflow:hidden clipping) -->
{fetchOk && (
  <div class="modal-overlay" id="downloadsModal" style="display: none;">
    <div class="modal">
      <button class="modal-close" id="modalClose">&times;</button>
      <h2>Download Stats</h2>
      <div class="modal-list" id="downloadsList">
        <div class="modal-grand-total">
          <div class="modal-grand-total-value" data-count={totalDownloads}>0</div>
          <div class="modal-grand-total-label">Total Downloads</div>
        </div>
        <div class="modal-cards">
          {groupedData.map((group, idx) => (
            <div class="modal-card" style={`animation-delay: ${idx * 100}ms;`}>
              <div class="modal-card-header">
                <div class="modal-card-os">
                  <Fragment set:html={getFamilyIcon(group.family)} />
                  <span>{group.family}</span>
                </div>
                <div class="modal-card-count" data-count={group.total}>0</div>
              </div>
              <div class="modal-card-progress">
                <div class="modal-card-bar" data-percentage={group.percentage} style="width: 0%"></div>
              </div>
              <div class="modal-card-percentage">{group.percentage}% of all downloads</div>
              {group.items.length > 1 && (
                <div class="modal-card-items">
                  {group.items.map((item) => (
                    <div class="modal-card-subitem">
                      <span class="modal-card-subitem-name">{item.name.replace(group.family, '').replace('(', '').replace(')', '').trim() || item.name}</span>
                      <span class="modal-card-subitem-count" data-count={item.count}>0</span>
                    </div>
                  ))}
                </div>
              )}
            </div>
          ))}
        </div>
      </div>
    </div>
  </div>
)}

<script>
  // ‚îÄ‚îÄ Stats animations + modal toggle ‚îÄ‚îÄ
  function formatNumber(n: number): string {
    if (n >= 1_000_000) return (n / 1_000_000).toFixed(1).replace(/\.0$/, '') + 'M';
    if (n >= 1_000) return (n / 1_000).toFixed(1).replace(/\.0$/, '') + 'k';
    return n.toLocaleString();
  }

  function animateValue(el: HTMLElement, end: number, duration: number) {
    const startTime = performance.now();
    const formatted = formatNumber(end);

    function update(now: number) {
      const elapsed = now - startTime;
      const progress = Math.min(elapsed / duration, 1);
      const eased = 1 - Math.pow(1 - progress, 3);
      const current = Math.floor(eased * end);
      el.textContent = progress < 1 ? formatNumber(current) : formatted;
      if (progress < 1) requestAnimationFrame(update);
    }
    requestAnimationFrame(update);
  }

  // Animate stats row counters on load
  const dlEl = document.getElementById('statDownloads');
  const starsEl = document.getElementById('statStars');

  if (dlEl?.dataset.count) animateValue(dlEl, parseInt(dlEl.dataset.count, 10), 1200);
  if (starsEl?.dataset.count) animateValue(starsEl, parseInt(starsEl.dataset.count, 10), 1200);

  // Modal open/close
  const modal = document.getElementById('downloadsModal');
  const modalClose = document.getElementById('modalClose');
  const downloadsList = document.getElementById('downloadsList');
  const downloadsItem = document.getElementById('statDownloadsItem');

  if (downloadsItem && modal && modalClose && downloadsList) {
    downloadsItem.addEventListener('click', () => {
      modal.style.display = 'flex';

      // Reset and animate grand total
      const grandTotalEl = downloadsList.querySelector('.modal-grand-total-value') as HTMLElement;
      if (grandTotalEl?.dataset.count) {
        grandTotalEl.textContent = '0';
        animateValue(grandTotalEl, parseInt(grandTotalEl.dataset.count, 10), 1000);
      }

      // Reset and animate card counts
      downloadsList.querySelectorAll('.modal-card-count').forEach((el) => {
        const target = parseInt((el as HTMLElement).dataset.count || '0', 10);
        (el as HTMLElement).textContent = '0';
        animateValue(el as HTMLElement, target, 800);
      });

      // Reset and animate sub-item counts
      downloadsList.querySelectorAll('.modal-card-subitem-count').forEach((el) => {
        const target = parseInt((el as HTMLElement).dataset.count || '0', 10);
        (el as HTMLElement).textContent = '0';
        animateValue(el as HTMLElement, target, 800);
      });

      // Reset and animate progress bars
      downloadsList.querySelectorAll('.modal-card-bar').forEach((el) => {
        (el as HTMLElement).style.width = '0%';
      });
      requestAnimationFrame(() => {
        downloadsList.querySelectorAll('.modal-card-bar').forEach((el) => {
          const pct = (el as HTMLElement).dataset.percentage || '0';
          (el as HTMLElement).style.width = pct + '%';
        });
      });

      // Reset card animations
      downloadsList.querySelectorAll('.modal-card').forEach((el) => {
        const card = el as HTMLElement;
        card.style.animation = 'none';
        card.offsetHeight; // force reflow
        card.style.animation = '';
      });
    });

    modalClose.addEventListener('click', () => {
      modal.style.display = 'none';
    });

    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.style.display = 'none';
      }
    });
  }
</script>

<style>
  .hero {
    padding: 4rem 0 3rem;
    background: linear-gradient(180deg, var(--bg-deep) 0%, var(--bg-dark) 100%);
    position: relative;
    overflow: hidden;
  }

  .hero-bg {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0.7;
    filter: grayscale(50%) sepia(30%) hue-rotate(220deg) brightness(0.6);
    mix-blend-mode: luminosity;
    z-index: 0;
    pointer-events: none;
    mask-image: radial-gradient(ellipse at center 40%, black 20%, transparent 70%);
    -webkit-mask-image: radial-gradient(ellipse at center 40%, black 20%, transparent 70%);
  }

  .hero::before {
    content: '';
    position: absolute;
    top: -60px;
    left: 50%;
    transform: translateX(-50%);
    width: 600px;
    height: 600px;
    background: radial-gradient(ellipse at center, rgba(180, 0, 255, 0.06) 0%, rgba(0, 255, 255, 0.02) 40%, transparent 70%);
    pointer-events: none;
  }

  .hero-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    position: relative;
    z-index: 2;
  }

  /* ‚îÄ‚îÄ Chip Icon - pixel art scaled up ‚îÄ‚îÄ */
  .chip-container {
    position: relative;
    width: 176px;
    height: 176px;
    margin-bottom: 2rem;
    --float-speed: 6s;
    cursor: none;
  }

  .chip-glow {
    position: absolute;
    inset: -40px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(180, 0, 255, 0.15) 0%, rgba(0, 255, 255, 0.04) 40%, transparent 70%);
    animation: chip-breathe 4s ease-in-out infinite;
    pointer-events: none;
  }

  @keyframes chip-breathe {
    0%, 100% { opacity: 0.5; transform: scale(1); }
    50% { opacity: 0.8; transform: scale(1.05); }
  }

  .chip-icon {
    width: 100%;
    height: 100%;
    /* Pixel-art: no anti-aliasing - crisp upscaling like the real 22px icon */
    image-rendering: pixelated;
    image-rendering: crisp-edges;
    filter: drop-shadow(0 0 6px rgba(180, 0, 255, 0.25)) drop-shadow(0 0 15px rgba(0, 255, 255, 0.08));
    animation: chip-float var(--float-speed) ease-in-out infinite;
    transition: filter 0.3s ease;
  }

  /* Subtle glow increase when fleeing */
  .chip-container:hover .chip-icon {
    filter: drop-shadow(0 0 10px rgba(180, 0, 255, 0.35)) drop-shadow(0 0 20px rgba(0, 255, 255, 0.12));
  }

  .chip-container:hover .chip-glow {
    opacity: 0.9;
    transform: scale(1.1);
  }

  @keyframes chip-float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-6px); }
  }

  /* ‚îÄ‚îÄ Text ‚îÄ‚îÄ */
  .hero-text {
    margin-bottom: 3rem;
  }

  .hero-text h1 {
    font-size: 3.5rem;
    font-weight: 700;
    line-height: 1.1;
    color: var(--text-primary);
    margin: 0 0 0.75rem;
    letter-spacing: -0.02em;
  }

  .highlight {
    color: var(--accent);
  }

  .tagline {
    font-size: 1.1rem;
    font-weight: 500;
    color: #c080ff;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin: 0 0 1rem;
  }

  .subtitle {
    font-size: 1.15rem;
    color: var(--text-primary);
    line-height: 1.6;
    margin: 0 0 2rem;
    max-width: 480px;
    margin-left: auto;
    margin-right: auto;
    text-shadow: 0 0 30px rgba(15, 13, 20, 0.95), 0 0 60px rgba(15, 13, 20, 0.85);
  }

  /* ‚îÄ‚îÄ Buttons ‚îÄ‚îÄ */
  .hero-buttons {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
  }

  .btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.85rem 1.75rem;
    border-radius: 50px;
    text-decoration: none;
    font-weight: 600;
    font-size: 0.95rem;
    transition: all 0.2s ease;
    cursor: pointer;
    border: none;
  }

  .btn-primary {
    background: var(--accent);
    color: var(--bg-deep);
    box-shadow: 0 4px 15px rgba(176, 112, 224, 0.3);
  }

  .btn-primary:hover {
    background: var(--accent-bright);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(176, 112, 224, 0.4);
  }

  .btn-outline {
    background: rgba(15, 13, 20, 0.7);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    color: var(--text-primary);
    border: 2px solid var(--border-hover);
  }

  .btn-outline:hover {
    border-color: var(--accent);
    color: var(--accent);
    background: rgba(176, 112, 224, 0.05);
  }

  /* ‚îÄ‚îÄ Stats row ‚îÄ‚îÄ */
  .stats-row {
    display: flex;
    gap: 1.5rem;
    justify-content: center;
    margin-top: 3.5rem;
    margin-bottom: 0;
  }

  .stat-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
    padding: 0.75rem 1.25rem;
    border-radius: 12px;
    min-width: 100px;
    transition: all 0.3s ease;
    background: rgba(15, 13, 20, 0.6);
    backdrop-filter: blur(8px);
    border: 1px solid rgba(180, 0, 255, 0.15);
  }

  .stat-item:hover {
    transform: translateY(-3px);
    border-color: rgba(180, 0, 255, 0.4);
    box-shadow:
      0 0 20px rgba(180, 0, 255, 0.15),
      0 0 40px rgba(0, 255, 255, 0.05),
      inset 0 1px 0 rgba(180, 0, 255, 0.1);
  }

  .stat-value {
    font-size: 1.5rem;
    font-weight: 800;
    font-family: 'JetBrains Mono', 'Fira Code', 'Cascadia Code', 'SF Mono', Consolas, monospace;
    letter-spacing: -0.02em;
    color: #c080ff;
    text-shadow: 0 0 20px rgba(192, 128, 255, 0.4);
  }

  .stat-label {
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    opacity: 0.6;
    font-family: 'JetBrains Mono', 'Fira Code', 'Cascadia Code', 'SF Mono', Consolas, monospace;
    color: var(--text-muted);
  }

  @media (max-width: 640px) {
    .stats-row {
      gap: 0.75rem;
    }

    .stat-item {
      padding: 0.5rem 0.75rem;
      min-width: 80px;
    }

    .stat-value {
      font-size: 1.15rem;
    }

    .stat-label {
      font-size: 0.6rem;
    }
  }

  /* ‚îÄ‚îÄ Modal ‚îÄ‚îÄ */
  .modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(8px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    animation: overlayFadeIn 0.3s ease-out;
  }

  @keyframes overlayFadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  .modal {
    background: linear-gradient(180deg, rgba(30, 25, 45, 0.98) 0%, rgba(15, 13, 20, 0.98) 100%);
    border: 1px solid rgba(180, 0, 255, 0.4);
    border-radius: 20px;
    padding: 2rem;
    max-width: 480px;
    width: 90%;
    max-height: 85vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    position: relative;
    box-shadow:
      0 0 60px rgba(180, 0, 255, 0.3),
      0 0 100px rgba(0, 255, 255, 0.15),
      inset 0 1px 0 rgba(255, 255, 255, 0.05);
    animation: modalFadeIn 0.3s ease-out;
  }

  @keyframes modalFadeIn {
    from {
      opacity: 0;
      transform: scale(0.95) translateY(10px);
    }
    to {
      opacity: 1;
      transform: scale(1) translateY(0);
    }
  }

  .modal::before {
    content: '';
    position: absolute;
    inset: -1px;
    border-radius: 20px;
    padding: 1px;
    background: linear-gradient(135deg, rgba(180, 0, 255, 0.6), rgba(0, 255, 255, 0.3), rgba(180, 0, 255, 0.6));
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    pointer-events: none;
  }

  .modal h2 {
    margin: 0 0 0.75rem;
    font-size: 1.5rem;
    color: #c080ff;
    text-align: center;
    font-family: 'JetBrains Mono', 'Fira Code', monospace;
    text-shadow: 0 0 20px rgba(192, 128, 255, 0.5);
    letter-spacing: 0.05em;
  }

  .modal-close {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: none;
    border: none;
    color: var(--text-muted);
    font-size: 1.5rem;
    cursor: pointer;
    padding: 0.25rem 0.5rem;
    line-height: 1;
    transition: color 0.2s;
    z-index: 1;
  }

  .modal-close:hover {
    color: #c080ff;
  }

  .modal-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    overflow-y: auto;
    flex: 1;
    min-height: 0;
    padding-right: 0.25rem;
  }

  /* ‚îÄ‚îÄ Dynamic modal content (injected via JS, needs :global) ‚îÄ‚îÄ */

  /* Grand Total */
  .modal-list :global(.modal-grand-total) {
    text-align: center;
    padding: 1.25rem 1rem;
    margin-bottom: 0.25rem;
    border-bottom: 1px solid rgba(180, 0, 255, 0.15);
  }

  .modal-list :global(.modal-grand-total-value) {
    font-family: 'JetBrains Mono', 'Fira Code', monospace;
    font-size: 2.75rem;
    font-weight: 800;
    color: #c080ff;
    letter-spacing: -0.02em;
    text-shadow: 0 0 20px rgba(192, 128, 255, 0.4);
    line-height: 1.1;
  }

  .modal-list :global(.modal-grand-total-label) {
    font-family: 'JetBrains Mono', 'Fira Code', monospace;
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 0.15em;
    color: var(--text-muted);
    opacity: 0.7;
    margin-top: 0.35rem;
  }

  /* Cards Container */
  .modal-list :global(.modal-cards) {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  /* Platform Card */
  .modal-list :global(.modal-card) {
    background: linear-gradient(135deg, rgba(180, 0, 255, 0.06) 0%, rgba(0, 255, 255, 0.03) 100%);
    border: 1px solid rgba(180, 0, 255, 0.2);
    border-radius: 14px;
    padding: 1rem 1.25rem;
    transition: all 0.3s ease;
    animation: modalCardFadeIn 0.4s ease-out forwards;
    opacity: 0;
    transform: translateY(12px);
  }

  @keyframes modalCardFadeIn {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .modal-list :global(.modal-card:hover) {
    border-color: rgba(180, 0, 255, 0.45);
    background: linear-gradient(135deg, rgba(180, 0, 255, 0.1) 0%, rgba(0, 255, 255, 0.05) 100%);
    box-shadow:
      0 4px 24px rgba(180, 0, 255, 0.15),
      0 0 30px rgba(0, 255, 255, 0.08);
  }

  /* Card Header */
  .modal-list :global(.modal-card-header) {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.65rem;
  }

  .modal-list :global(.modal-card-os) {
    display: flex;
    align-items: center;
    gap: 0.6rem;
    font-family: 'JetBrains Mono', 'Fira Code', monospace;
    font-size: 1.05rem;
    font-weight: 600;
    color: var(--text-primary);
    letter-spacing: 0.02em;
  }

  .modal-list :global(.modal-card-os svg) {
    flex-shrink: 0;
  }

  .modal-list :global(.modal-card-count) {
    font-family: 'JetBrains Mono', 'Fira Code', monospace;
    font-size: 1.35rem;
    font-weight: 700;
    color: #c080ff;
    text-shadow: 0 0 12px rgba(192, 128, 255, 0.35);
    letter-spacing: 0.03em;
  }

  /* Progress Bar */
  .modal-list :global(.modal-card-progress) {
    width: 100%;
    height: 4px;
    background: rgba(255, 255, 255, 0.06);
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 0.4rem;
  }

  .modal-list :global(.modal-card-bar) {
    height: 100%;
    border-radius: 4px;
    background: linear-gradient(90deg, rgba(180, 0, 255, 0.7), rgba(0, 255, 255, 0.7));
    transition: width 1s cubic-bezier(0.22, 1, 0.36, 1);
    box-shadow: 0 0 6px rgba(180, 0, 255, 0.3);
  }

  /* Percentage Label */
  .modal-list :global(.modal-card-percentage) {
    font-family: 'JetBrains Mono', 'Fira Code', monospace;
    font-size: 0.65rem;
    color: var(--text-muted);
    opacity: 0.55;
    letter-spacing: 0.04em;
  }

  /* Sub-items (Linux breakdown) */
  .modal-list :global(.modal-card-items) {
    margin-top: 0.6rem;
    padding-top: 0.6rem;
    border-top: 1px solid rgba(180, 0, 255, 0.1);
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
  }

  .modal-list :global(.modal-card-subitem) {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.35rem 0.5rem;
    border-radius: 8px;
    background: rgba(180, 0, 255, 0.04);
  }

  .modal-list :global(.modal-card-subitem-name) {
    font-family: 'JetBrains Mono', 'Fira Code', monospace;
    font-size: 0.8rem;
    color: var(--text-muted);
    opacity: 0.8;
    letter-spacing: 0.02em;
  }

  .modal-list :global(.modal-card-subitem-count) {
    font-family: 'JetBrains Mono', 'Fira Code', monospace;
    font-size: 0.9rem;
    font-weight: 600;
    color: rgba(192, 128, 255, 0.75);
    letter-spacing: 0.03em;
  }

  /* ‚îÄ‚îÄ Screenshots ‚îÄ‚îÄ */
  .hero-screenshots {
    display: flex;
    gap: 1.5rem;
    justify-content: center;
    flex-wrap: wrap;
    margin-top: 1rem;
  }

  .screenshot-linux,
  .screenshot-windows {
    width: 320px;
    border-radius: var(--radius);
    overflow: hidden;
    box-shadow: var(--shadow-elevated);
    border: 1px solid var(--border-dark);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .screenshot-windows {
    background: #1a1625;
    border-color: #3d2f5c;
  }

  .screenshot-linux:hover,
  .screenshot-windows:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-elevated), var(--shadow-glow);
  }

  .screenshot-linux img,
  .screenshot-windows img {
    width: 100%;
    height: auto;
    display: block;
  }

  /* ‚îÄ‚îÄ Responsive ‚îÄ‚îÄ */
  @media (max-width: 820px) {
    .hero {
      padding: 3rem 0 2rem;
    }

    .chip-container {
      width: 140px;
      height: 140px;
    }

    .hero-text h1 {
      font-size: 2.5rem;
    }

    .tagline {
      font-size: 0.9rem;
    }

    .screenshot-linux,
    .screenshot-windows {
      width: 280px;
    }
  }

  @media (max-width: 640px) {
    .chip-container {
      width: 110px;
      height: 110px;
      margin-bottom: 1.5rem;
    }

    .hero-text h1 {
      font-size: 2rem;
    }

    .screenshot-linux,
    .screenshot-windows {
      width: 100%;
      max-width: 300px;
    }
  }
</style>
